<airframe name="MERCURY_CSC">

  <!-- Four Motors -->
  <section name="BUSS_TWI" prefix="BUSS_TWI_BLMC_">
    <define name="NB" value="8" />
    <define name="NB_SEND" value="6" />
  </section>
  <section name="BUSS_BLMC" prefix="BUSS_BLMC_">
    <define name="ADDR" value="{ 0x52, 0x54, 0x56, 0x58, 0x5A, 0x5E, 0x5C, 0x60 }"/>
  </section>

  <!-- Up to Four Servos -->
  <servos>
    <servo name="S1" no="0" min="1000" neutral="1500" max="2000"/>
    <servo name="S2" no="1" min="1000" neutral="1500" max="2000"/>
    <servo name="S3" no="3" min="1000" neutral="1500" max="2000"/>
    <servo name="S4" no="2" min="1000" neutral="1500" max="2000"/> 
  </servos>
  
  <section name="MISC">
    <define name="TWI_IGNORE_ACK" value="1" /> 
  </section>


  <makefile>

ap.CFLAGS += -DPWM_SERVO_4 -DPWM_SERVO_5 -DPWM_SERVO_0 # -DPWM_SERVO_3
CSC_ID=0
SRC_BOOZ=booz
SRC_BOOZ_ARCH=booz/arm7
ap.CFLAGS += -I$(SRC_BOOZ) -I$(SRC_BOOZ_ARCH)

ap.CFLAGS += -DSPEKTRUM_LINK=Uart1 -DUSE_UART1 -DUART1_BAUD=B115200 -DUART1_VIC_SLOT=6
ap.srcs += $(SRC_CSC)/csc_rc_spektrum.c

#ap.CFLAGS += -DCAN1_BTR=CANBitrate125k_2MHz
#ap.CFLAGS += -DCAN1_BTR=CANBitrate312k5_5MHz
ap.CFLAGS += -DCAN1_BTR=CANBitrate187k5_3MHz
#ap.CFLAGS += -DCAN1_BTR=CANBitrate156k25_2_5MHz

ap.CFLAGS += -DMOTORS=\"buss_twi_blmc_hw.h\" -DUSE_BUSS_TWI_BLMC_MOTOR
ap.srcs += $(SRC_CSC_ARCH)/buss_twi_blmc_hw.c
# on I2C0
ap.CFLAGS += -DUSE_I2C0 -DI2C0_SCLL=125 -DI2C0_SCLH=125 -DI2C0_VIC_SLOT=10
ap.CFLAGS += -DI2C0_STOP_HANDLER_HEADER=\"csc/arm7/buss_twi_blmc_hw.h\" -DI2C0_STOP_HANDLER="motors_commit_next"
ap.srcs += i2c.c $(SRC_ARCH)/i2c_hw.c

include $(PAPARAZZI_SRC)/conf/autopilot/mercury_csc.makefile
include $(PAPARAZZI_SRC)/conf/autopilot/mercury_csc_uart0_pprz.makefile
include $(PAPARAZZI_SRC)/conf/autopilot/pwm_input.makefile
include $(PAPARAZZI_SRC)/conf/autopilot/vane_sensor.makefile


  </makefile>

</airframe>
