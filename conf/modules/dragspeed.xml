<!DOCTYPE module SYSTEM "module.dtd">

<module name="dragspeed">
  <doc>
    <description>
      This module estimates the velocity of rotorcraft by measuring the drag force
      using the accelerometer.
   
      During flight, gravity, thrust and drag act on the quadrotor. Only the drag
      is measured along the quadrotor's horizontal axes. Using a simple linear drag
      model, this deceleration can be transformed back into an estimate of the
      drone's airspeed.
   
      This module makes the following assumptions:
      - The drag acting on the quadrotor grows linearly with velocity.
      - The size and weight of the drone are constant (changes in size and weight
        require re-calibration).
      - Pitch and roll angles are small (less than ~20 deg).
      - No wind (when used as ground speed).
    </description>
    <define name="DRAGSPEED_SEND_ABI_MESSAGE" description="Send VELOCITY_ESTIMATE ABI messages" value="TRUE|FALSE (default: TRUE)"/>
    <define name="DRAGSPEED_ACCEL_ID" description="Accelerometer ABI ID to subscribe to (default: ABI_BROADCAST)"/>
    <define name="DRAGSPEED_COEFF" description="Drag coefficient (mu/m), where Drag coefficient (mu/m) of the linear drag model, where m*a = v*mu"/>
    <define name="DRAGSPEED_ZERO_X" description="Accelerometer reading (x axis) when stationary [m/s^2]"/>
    <define name="DRAGSPEED_ZERO_Y" description="Accelerometer reading (y axis) when stationary [m/s^2]"/>
    <define name="DRAGSPEED_R" description="Velocity measurement noise variance [(m/s)^2]"/>
    <define name="DRAGSPEED_FILTER" description="First-order low-pass filter strength [0..1] (default: 0.8)"/>
  </doc>
  <settings>
    <dl_settings>
      <dl_settings name="dragspeed">
        <dl_setting shortname="Coeff X" var="dragspeed.coeff.x" min="0" step="0.01" max="2.0"/>
        <dl_setting shortname="Coeff Y" var="dragspeed.coeff.y" min="0" step="0.01" max="2.0"/>
        <dl_setting shortname="Calibrate coeff" var="dragspeed.calibrate_coeff" min="0" step="1" max="1"/>
        <dl_setting shortname="Filter" var="dragspeed.filter" min="0" step="0.01" max="1.0"/>
        <dl_setting shortname="Zero_X" var="dragspeed.zero.x" min="-2.0" step="0.01" max="2.0"/>
        <dl_setting shortname="Zero_Y" var="dragspeed.zero.y" min="-2.0" step="0.01" max="2.0"/>
        <dl_setting shortname="Calibrate zero" var="dragspeed.calibrate_zero" min="0" step="1" max="1"/>
      </dl_settings>
    </dl_settings>
  </settings>
  <header>
    <file name="dragspeed.h"/>
  </header>
  <init fun="dragspeed_init()"/>
  <makefile>
    <file name="dragspeed.c"/>
  </makefile>
</module>

